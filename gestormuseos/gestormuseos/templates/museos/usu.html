{% extends 'museos/base.html' %}    <!--Hereda de base.html-->

<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.css">
  
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.js"></script>

$(document).ready( function () {
    $('table_id').DataTable();
} );

{% block head %}
    {% if user.is_authenticated %}
        {% if nombre_pag %}
             <h1><b><u>{{configuracion.nombre_pag}}</u></b></h1>   <!--Lo coge del formulario de cambiar nombre-->
        {% else %}
            <h1><b><u>Los museos favoritos de {{usuario.usuario}} son:</u></b></h1><br>
        {% endif %}

    {% else %}    
        <h1><b><u>Los museos favoritos de {{usuario.usuario}} son:</u></b></h1><br>
    {% endif %}

{% endblock %}

{% block opciones %}

    <li id="inicio" class="menu"><a href="/">INICIO</a></li>
    <li id="about" class="menu"><a href="/about">ABOUT</a></li>
    <li id="museos" class="menu"><a href="/museos">TODOS</a></li>
    <li id="admin" class="menu"><a href='/admin'>Página admin</a></li>
    <li id="login" class="menu">
        {% if user.is_authenticated %}
            <div>Usuario: {{ user.get_username }}</div>   <!--Sólo se ve si está autenticado--> 
            <div><a href="{% url 'logout'%}?next={{request.path}}">Logout</a></div>   
        {% else %}
            <div><a href="{% url 'login'%}?next={{request.path}}">Login</a></div>
            
        {% endif %}                                                                                                                                                                        
    </li>    
    
{% endblock %}

{% block barra %}

    <li id="usuxml" class="menu"><a href="/usuario/{{usuario.id}}/xml">VERSIÓN XML</a></li>
                
{% endblock %}

{% block barradcha %}

    {% if user.is_authenticated %}
        {% if usuario_ppal %}

            <!--FORMULARIO PARA CAMBIAR NOMBRE PÁG USUARIO-->
            <b><li>FORMULARIO PARA CAMBIAR NOMBRE PÁG USUARIO</li></b>
            <form method="post" action="/usuario/{{usuario.id}}/cambia_nombre">
                {% csrf_token %}
                {{form_nombre.as_p}}
                <input type="submit" value="Enviar" />
            </form>
            
            <!--FORMULARIO PARA CAMBIAR ESTILO CSS PÁG USUARIO-->
            <b><li>FORMULARIO PARA CAMBIAR ESTILO CSS PÁG USUARIO</li></b>
            <form method="post" action="/usuario/{{usuario.id}}/cambia_estilo">
                {% csrf_token %}
                {{form_estilo.as_p}}
                <input type="submit" value="Enviar" />
            </form>

        {% endif %}
    {% endif %}

    <a class="button" href="/usuario/{{usuario.id}}/?acc=True">Vista solo acc</a>
    <a class="button" href="/usuario/{{usuario.id}}/">Vista normal</a>

{% endblock %}

{% block body %}
    
    <div id="table_id" class="display">
        <div class="table-responsive">
            <table class="table table-striped table-bordered table-hover">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Fecha</th>

                    </tr>
                </thead>
                <tbody>
                    {% if favoritos %}
                        {% for favorito in favoritos|slice:":5" %}
                            <tr>
                                <td><a href="/museos/{{favorito.id}}">{{favorito.museo}}</a></td>
                                <td>    {{favorito.fecha}}</td>                             
                            </tr>

                            {% if forloop.counter == 5 and not fin %}
                                <p class="siguientes"><a href="/usuario/{{favorito.configuracion.usuario.id_user}}">Siguiente página</a></p>
                            {% endif %}

                        {% endfor %}
                        
                    {% else %}
                        <tr>
                            <td colspan=4>Este usuario no tiene aparcamientos favoritos</td>
                        </tr>
                    {% endif %}
                </tbody>
            </table>
        </div>
    </div>

    {% if not user.is_authenticated %}

        <br>Usted no está identificado, si quiere modificar su configuración, inicie sesión<br>

    {% endif %}

{% endblock %}

